<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Longitudinal Data Analysis</title>
  <meta name="description" content="Applied Longitudinal Data Analysis">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Longitudinal Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://josh-jackson.github.io/longitudinal/" class="uri">https://josh-jackson.github.io/longitudinal/</a>" />
  
  <meta property="og:description" content="Applied Longitudinal Data Analysis" />
  <meta name="github-repo" content="josh-jackson/longitudinal" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Longitudinal Data Analysis" />
  
  <meta name="twitter:description" content="Applied Longitudinal Data Analysis" />
  

<meta name="author" content="Josh Jackson">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="01-Syllabus.html">
<link rel="next" href="03-Growth-curves.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li>ALDA</li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="01-Syllabus.html"><a href="01-Syllabus.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a></li>
<li class="chapter" data-level="2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html"><i class="fa fa-check"></i><b>2</b> LDA basics</a><ul>
<li class="chapter" data-level="2.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#motivation-terms-concepts"><i class="fa fa-check"></i><b>2.1</b> Motivation, terms, concepts</a><ul>
<li class="chapter" data-level="2.1.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#why-longtiduinal"><i class="fa fa-check"></i><b>2.1.1</b> Why longtiduinal?</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#types-of-change-most-common"><i class="fa fa-check"></i><b>2.1.2</b> Types of change (most common)</a></li>
<li class="chapter" data-level="2.1.3" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#between-person-versus-within-person"><i class="fa fa-check"></i><b>2.1.3</b> Between person versus within person</a></li>
<li class="chapter" data-level="2.1.4" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#trajectories-curves-change-growth-oh-my"><i class="fa fa-check"></i><b>2.1.4</b> Trajectories, curves, change, growth… oh my</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#data-analysis-and-data-structures"><i class="fa fa-check"></i><b>2.2</b> Data analysis and data structures</a><ul>
<li class="chapter" data-level="2.2.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#modeling-frameworks-mlm-sem"><i class="fa fa-check"></i><b>2.2.1</b> Modeling frameworks: MLM &amp; SEM</a></li>
<li class="chapter" data-level="2.2.2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#wide-and-long-form"><i class="fa fa-check"></i><b>2.2.2</b> Wide and Long form</a></li>
<li class="chapter" data-level="2.2.3" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#graphing"><i class="fa fa-check"></i><b>2.2.3</b> Graphing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#putting-it-together-example"><i class="fa fa-check"></i><b>2.3</b> Putting it together example</a><ul>
<li class="chapter" data-level="2.3.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#a-person-level"><i class="fa fa-check"></i><b>2.3.1</b> a person level</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#what-does-this-look-like"><i class="fa fa-check"></i><b>2.4</b> What does this look like?</a></li>
<li class="chapter" data-level="2.5" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#design-considerations"><i class="fa fa-check"></i><b>2.5</b> Design considerations</a><ul>
<li class="chapter" data-level="2.5.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#number-of-assessment-waves"><i class="fa fa-check"></i><b>2.5.1</b> number of assessment waves</a></li>
<li class="chapter" data-level="2.5.2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#measuremnt"><i class="fa fa-check"></i><b>2.5.2</b> measuremnt</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#threats-to-validity"><i class="fa fa-check"></i><b>2.6</b> Threats to validity</a><ul>
<li class="chapter" data-level="2.6.1" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#missing-data"><i class="fa fa-check"></i><b>2.6.1</b> Missing data</a></li>
<li class="chapter" data-level="2.6.2" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#attritionmortality"><i class="fa fa-check"></i><b>2.6.2</b> Attrition/Mortality</a></li>
<li class="chapter" data-level="2.6.3" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#historycohort"><i class="fa fa-check"></i><b>2.6.3</b> History/cohort</a></li>
<li class="chapter" data-level="2.6.4" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#maturation"><i class="fa fa-check"></i><b>2.6.4</b> Maturation</a></li>
<li class="chapter" data-level="2.6.5" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#testing"><i class="fa fa-check"></i><b>2.6.5</b> Testing</a></li>
<li class="chapter" data-level="2.6.6" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#selection"><i class="fa fa-check"></i><b>2.6.6</b> Selection</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#why-not-rm-anova"><i class="fa fa-check"></i><b>2.7</b> Why not RM ANOVA?</a></li>
<li class="chapter" data-level="2.8" data-path="02-LDA-basics.html"><a href="02-LDA-basics.html#now-you-try"><i class="fa fa-check"></i><b>2.8</b> Now you try</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html"><i class="fa fa-check"></i><b>3</b> Growth curves</a><ul>
<li class="chapter" data-level="3.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#between-person-models-and-cross-sectional-data"><i class="fa fa-check"></i><b>3.1</b> Between person models and cross sectional data</a></li>
<li class="chapter" data-level="3.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#within-person-models-e.g.-2-level-models"><i class="fa fa-check"></i><b>3.2</b> Within person models e.g., 2-level models</a><ul>
<li class="chapter" data-level="3.2.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#thinking-about-random-effects"><i class="fa fa-check"></i><b>3.2.1</b> thinking about random effects</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#random-effects"><i class="fa fa-check"></i><b>3.2.2</b> random effects</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#empty-model-equation"><i class="fa fa-check"></i><b>3.2.3</b> Empty model equation</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#putting-it-together"><i class="fa fa-check"></i><b>3.2.4</b> Putting it together</a></li>
<li class="chapter" data-level="3.2.5" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#empty-model"><i class="fa fa-check"></i><b>3.2.5</b> Empty model</a></li>
<li class="chapter" data-level="3.2.6" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#putting-it-together-1"><i class="fa fa-check"></i><b>3.2.6</b> Putting it together</a></li>
<li class="chapter" data-level="3.2.7" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#icc"><i class="fa fa-check"></i><b>3.2.7</b> ICC</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#adding-time"><i class="fa fa-check"></i><b>3.3</b> Adding time</a><ul>
<li class="chapter" data-level="3.3.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#what-does-this-look-like-graphically"><i class="fa fa-check"></i><b>3.3.1</b> What does this look like graphically?</a></li>
<li class="chapter" data-level="3.3.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#adding-a-random-slope"><i class="fa fa-check"></i><b>3.3.2</b> Adding a random slope?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#individaul-level-random-effects"><i class="fa fa-check"></i><b>3.4</b> Individaul level random effects</a><ul>
<li class="chapter" data-level="3.4.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#calculation-of-individaul-level-random-effects"><i class="fa fa-check"></i><b>3.4.1</b> Calculation of individaul level random effects</a></li>
<li class="chapter" data-level="3.4.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#how-are-these-random-effects-calculated"><i class="fa fa-check"></i><b>3.4.2</b> How are these random effects calculated?</a></li>
<li class="chapter" data-level="3.4.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#random-effects-and-residual-standard-assumptions"><i class="fa fa-check"></i><b>3.4.3</b> random effects and residual (standard) assumptions</a></li>
<li class="chapter" data-level="3.4.4" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#random-effect-decomposition"><i class="fa fa-check"></i><b>3.4.4</b> Random effect decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#working-with-models-in-r"><i class="fa fa-check"></i><b>3.5</b> working with models in R</a><ul>
<li class="chapter" data-level="3.5.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#basic-lmer-code"><i class="fa fa-check"></i><b>3.5.1</b> basic lmer code</a></li>
<li class="chapter" data-level="3.5.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#example"><i class="fa fa-check"></i><b>3.5.2</b> Example</a></li>
<li class="chapter" data-level="3.5.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#how-to-calculate-icc"><i class="fa fa-check"></i><b>3.5.3</b> How to calculate ICC?</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#exploring-beyond-the-summary"><i class="fa fa-check"></i><b>3.6</b> Exploring beyond the summary</a><ul>
<li class="chapter" data-level="3.6.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#what-do-the-random-effects-look-like"><i class="fa fa-check"></i><b>3.6.1</b> what do the random effects look like?</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#adding-time-to-the-mlm"><i class="fa fa-check"></i><b>3.7</b> Adding time to the MLM</a><ul>
<li class="chapter" data-level="3.7.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#fixed-slope"><i class="fa fa-check"></i><b>3.7.1</b> fixed slope</a></li>
<li class="chapter" data-level="3.7.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#random-slope"><i class="fa fa-check"></i><b>3.7.2</b> Random slope</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#random-effects-1"><i class="fa fa-check"></i><b>3.8</b> Random effects</a><ul>
<li class="chapter" data-level="3.8.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#calcualtion-of-random-effect-confidence-interval"><i class="fa fa-check"></i><b>3.8.1</b> Calcualtion of random effect confidence interval</a></li>
<li class="chapter" data-level="3.8.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#individaul-level-random-effects-1"><i class="fa fa-check"></i><b>3.8.2</b> Individaul level random effects</a></li>
<li class="chapter" data-level="3.8.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#adding-time-1"><i class="fa fa-check"></i><b>3.8.3</b> adding time</a></li>
<li class="chapter" data-level="3.8.4" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#caterpillar-plots"><i class="fa fa-check"></i><b>3.8.4</b> caterpillar plots</a></li>
<li class="chapter" data-level="3.8.5" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#density-of-individaul-random-effects"><i class="fa fa-check"></i><b>3.8.5</b> Density of individaul random effects</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#comparing-to-a-standard-linear-model"><i class="fa fa-check"></i><b>3.9</b> comparing to a standard linear model</a></li>
<li class="chapter" data-level="3.10" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#other-types-of-models"><i class="fa fa-check"></i><b>3.10</b> Other types of models</a></li>
<li class="chapter" data-level="3.11" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#matrix-notation-as-a-way-to-help-understand-what-is-going-on"><i class="fa fa-check"></i><b>3.11</b> Matrix notation (as a way to help understand what is going on)</a></li>
<li class="chapter" data-level="3.12" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#estimation"><i class="fa fa-check"></i><b>3.12</b> Estimation</a></li>
<li class="chapter" data-level="3.13" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#testing-significance-adapted-from-ben-bolker"><i class="fa fa-check"></i><b>3.13</b> Testing significance (adapted from Ben Bolker)</a><ul>
<li class="chapter" data-level="3.13.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#p-values-are-not-included"><i class="fa fa-check"></i><b>3.13.1</b> P values are not included</a></li>
<li class="chapter" data-level="3.13.2" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#likelhiood-ratio-test"><i class="fa fa-check"></i><b>3.13.2</b> Likelhiood ratio test</a></li>
<li class="chapter" data-level="3.13.3" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#likelihood-tests-for-random-effects"><i class="fa fa-check"></i><b>3.13.3</b> Likelihood tests for random effects</a></li>
<li class="chapter" data-level="3.13.4" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#aic-and-bic"><i class="fa fa-check"></i><b>3.13.4</b> AIC and BIC</a></li>
<li class="chapter" data-level="3.13.5" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#mcmc"><i class="fa fa-check"></i><b>3.13.5</b> MCMC</a></li>
<li class="chapter" data-level="3.13.6" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#bootstraps"><i class="fa fa-check"></i><b>3.13.6</b> Bootstraps</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#predictions-and-prediction-intervals"><i class="fa fa-check"></i><b>3.14</b> Predictions and prediction intervals</a><ul>
<li class="chapter" data-level="3.14.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#predictions-and-prediction-intervals-1"><i class="fa fa-check"></i><b>3.14.1</b> Predictions and prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#coefficient-of-determination-equivalents"><i class="fa fa-check"></i><b>3.15</b> Coefficient of determination equivalents</a><ul>
<li class="chapter" data-level="3.15.1" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#batch-analyses"><i class="fa fa-check"></i><b>3.15.1</b> batch analyses</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="03-Growth-curves.html"><a href="03-Growth-curves.html#now-you-try-1"><i class="fa fa-check"></i><b>3.16</b> Now you try:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-conditional.html"><a href="04-conditional.html"><i class="fa fa-check"></i><b>4</b> Conditional Predictors in growth models</a><ul>
<li class="chapter" data-level="4.1" data-path="04-conditional.html"><a href="04-conditional.html#intercept-effects"><i class="fa fa-check"></i><b>4.1</b> Intercept effects</a><ul>
<li class="chapter" data-level="4.1.1" data-path="04-conditional.html"><a href="04-conditional.html#seperatinng-these-into-intercept-and-slope"><i class="fa fa-check"></i><b>4.1.1</b> Seperatinng these into intercept and slope</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-conditional.html"><a href="04-conditional.html#slope-and-intercept-effects"><i class="fa fa-check"></i><b>4.2</b> Slope and Intercept effects</a><ul>
<li class="chapter" data-level="4.2.1" data-path="04-conditional.html"><a href="04-conditional.html#equations-necessary-for-plotting"><i class="fa fa-check"></i><b>4.2.1</b> Equations necessary for plotting</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="04-conditional.html"><a href="04-conditional.html#need-for-thinking-about-scaling-your-predictors"><i class="fa fa-check"></i><b>4.3</b> Need for thinking about scaling your predictors</a></li>
<li class="chapter" data-level="4.4" data-path="04-conditional.html"><a href="04-conditional.html#time-varying-covariates-tvcs"><i class="fa fa-check"></i><b>4.4</b> Time-varying covariates (TVCs)</a></li>
<li class="chapter" data-level="4.5" data-path="04-conditional.html"><a href="04-conditional.html#now-you-try-2"><i class="fa fa-check"></i><b>4.5</b> Now you try</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-poly-splines.html"><a href="05-poly-splines.html"><i class="fa fa-check"></i><b>5</b> Polynomial and Splines</a><ul>
<li class="chapter" data-level="5.1" data-path="05-poly-splines.html"><a href="05-poly-splines.html#polynomaials"><i class="fa fa-check"></i><b>5.1</b> Polynomaials</a></li>
<li class="chapter" data-level="5.2" data-path="05-poly-splines.html"><a href="05-poly-splines.html#polynomial-example"><i class="fa fa-check"></i><b>5.2</b> polynomial example</a><ul>
<li class="chapter" data-level="5.2.1" data-path="05-poly-splines.html"><a href="05-poly-splines.html#importance-of-centering"><i class="fa fa-check"></i><b>5.2.1</b> importance of centering</a></li>
<li class="chapter" data-level="5.2.2" data-path="05-poly-splines.html"><a href="05-poly-splines.html#random-terms"><i class="fa fa-check"></i><b>5.2.2</b> random terms</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="05-poly-splines.html"><a href="05-poly-splines.html#splines-aka-piecewise"><i class="fa fa-check"></i><b>5.3</b> Splines aka piecewise</a><ul>
<li class="chapter" data-level="5.3.1" data-path="05-poly-splines.html"><a href="05-poly-splines.html#seperate-curves"><i class="fa fa-check"></i><b>5.3.1</b> seperate curves</a></li>
<li class="chapter" data-level="5.3.2" data-path="05-poly-splines.html"><a href="05-poly-splines.html#incremental-curves"><i class="fa fa-check"></i><b>5.3.2</b> incremental curves</a></li>
<li class="chapter" data-level="5.3.3" data-path="05-poly-splines.html"><a href="05-poly-splines.html#splines-example"><i class="fa fa-check"></i><b>5.3.3</b> splines example</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="05-poly-splines.html"><a href="05-poly-splines.html#splines-polynomail-polynomial-piecewise"><i class="fa fa-check"></i><b>5.4</b> splines + polynomail = polynomial piecewise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-intensive-longitudinal.html"><a href="06-intensive-longitudinal.html"><i class="fa fa-check"></i><b>6</b> Intensive Longitudinal Designs</a><ul>
<li class="chapter" data-level="6.1" data-path="06-intensive-longitudinal.html"><a href="06-intensive-longitudinal.html#within-versus-between-person-processes"><i class="fa fa-check"></i><b>6.1</b> within versus between person processes</a></li>
<li class="chapter" data-level="6.2" data-path="06-intensive-longitudinal.html"><a href="06-intensive-longitudinal.html#centering"><i class="fa fa-check"></i><b>6.2</b> Centering</a><ul>
<li class="chapter" data-level="6.2.1" data-path="06-intensive-longitudinal.html"><a href="06-intensive-longitudinal.html#within-person"><i class="fa fa-check"></i><b>6.2.1</b> within person</a></li>
<li class="chapter" data-level="6.2.2" data-path="06-intensive-longitudinal.html"><a href="06-intensive-longitudinal.html#grand-mean"><i class="fa fa-check"></i><b>6.2.2</b> Grand mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-SEM.html"><a href="07-SEM.html"><i class="fa fa-check"></i><b>7</b> SEM</a><ul>
<li class="chapter" data-level="7.1" data-path="07-SEM.html"><a href="07-SEM.html#structural-equation-modeling"><i class="fa fa-check"></i><b>7.1</b> Structural Equation Modeling</a></li>
<li class="chapter" data-level="7.2" data-path="07-SEM.html"><a href="07-SEM.html#latent-variables"><i class="fa fa-check"></i><b>7.2</b> Latent variables</a><ul>
<li class="chapter" data-level="7.2.1" data-path="07-SEM.html"><a href="07-SEM.html#more-pretty-pictures"><i class="fa fa-check"></i><b>7.2.1</b> More pretty pictures</a></li>
<li class="chapter" data-level="7.2.2" data-path="07-SEM.html"><a href="07-SEM.html#classical-test-theory-interpretation"><i class="fa fa-check"></i><b>7.2.2</b> Classical test theory interpretation</a></li>
<li class="chapter" data-level="7.2.3" data-path="07-SEM.html"><a href="07-SEM.html#generizability-interpretation-of-latent-variables"><i class="fa fa-check"></i><b>7.2.3</b> Generizability interpretation of latent variables</a></li>
<li class="chapter" data-level="7.2.4" data-path="07-SEM.html"><a href="07-SEM.html#measurement-error"><i class="fa fa-check"></i><b>7.2.4</b> measurement error</a></li>
<li class="chapter" data-level="7.2.5" data-path="07-SEM.html"><a href="07-SEM.html#regarding-means"><i class="fa fa-check"></i><b>7.2.5</b> regarding means</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="07-SEM.html"><a href="07-SEM.html#goal-of-sem"><i class="fa fa-check"></i><b>7.3</b> goal of SEM</a><ul>
<li class="chapter" data-level="7.3.1" data-path="07-SEM.html"><a href="07-SEM.html#what-questions-can-be-asked"><i class="fa fa-check"></i><b>7.3.1</b> What questions can be asked?</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="07-SEM.html"><a href="07-SEM.html#setting-the-scale-and-defining-variables"><i class="fa fa-check"></i><b>7.4</b> Setting the scale and defining variables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="07-SEM.html"><a href="07-SEM.html#identification"><i class="fa fa-check"></i><b>7.4.1</b> identification</a></li>
<li class="chapter" data-level="7.4.2" data-path="07-SEM.html"><a href="07-SEM.html#types-of-identification"><i class="fa fa-check"></i><b>7.4.2</b> types of identification</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="07-SEM.html"><a href="07-SEM.html#lavaan"><i class="fa fa-check"></i><b>7.5</b> lavaan</a><ul>
<li class="chapter" data-level="7.5.1" data-path="07-SEM.html"><a href="07-SEM.html#lavaan-language"><i class="fa fa-check"></i><b>7.5.1</b> lavaan language</a></li>
<li class="chapter" data-level="7.5.2" data-path="07-SEM.html"><a href="07-SEM.html#how-to-run-lavaan"><i class="fa fa-check"></i><b>7.5.2</b> How to run lavaan</a></li>
<li class="chapter" data-level="7.5.3" data-path="07-SEM.html"><a href="07-SEM.html#lavaan-defaults"><i class="fa fa-check"></i><b>7.5.3</b> lavaan defaults</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="07-SEM.html"><a href="07-SEM.html#additional-sem-details"><i class="fa fa-check"></i><b>7.6</b> additional SEM details</a><ul>
<li class="chapter" data-level="7.6.1" data-path="07-SEM.html"><a href="07-SEM.html#coding-revisited"><i class="fa fa-check"></i><b>7.6.1</b> coding revisited</a></li>
<<<<<<< HEAD
<li class="chapter" data-level="7.6.2" data-path="07-SEM.html"><a href="07-SEM.html#plotting"><i class="fa fa-check"></i><b>7.6.2</b> plotting</a></li>
<li class="chapter" data-level="7.6.3" data-path="07-SEM.html"><a href="07-SEM.html#fit-indices"><i class="fa fa-check"></i><b>7.6.3</b> Fit Indices</a></li>
<li class="chapter" data-level="7.6.4" data-path="07-SEM.html"><a href="07-SEM.html#comparing-models"><i class="fa fa-check"></i><b>7.6.4</b> Comparing models</a></li>
<li class="chapter" data-level="7.6.5" data-path="07-SEM.html"><a href="07-SEM.html#parcels"><i class="fa fa-check"></i><b>7.6.5</b> Parcels</a></li>
<li class="chapter" data-level="7.6.6" data-path="07-SEM.html"><a href="07-SEM.html#estimators"><i class="fa fa-check"></i><b>7.6.6</b> Estimators</a></li>
=======
<li class="chapter" data-level="7.6.2" data-path="07-SEM.html"><a href="07-SEM.html#fit-indices"><i class="fa fa-check"></i><b>7.6.2</b> Fit Indices</a></li>
<li class="chapter" data-level="7.6.3" data-path="07-SEM.html"><a href="07-SEM.html#comparing-models"><i class="fa fa-check"></i><b>7.6.3</b> Comparing models</a></li>
<li class="chapter" data-level="7.6.4" data-path="07-SEM.html"><a href="07-SEM.html#parcels"><i class="fa fa-check"></i><b>7.6.4</b> Parcels</a></li>
<li class="chapter" data-level="7.6.5" data-path="07-SEM.html"><a href="07-SEM.html#estimators"><i class="fa fa-check"></i><b>7.6.5</b> Estimators</a></li>
>>>>>>> adaed47aa3b6ae705ade898eb3ebb25511a0e3d1
</ul></li>
<li class="chapter" data-level="7.7" data-path="07-SEM.html"><a href="07-SEM.html#measurement-invariance-mi"><i class="fa fa-check"></i><b>7.7</b> Measurement Invariance (MI)</a></li>
<li class="chapter" data-level="7.8" data-path="07-SEM.html"><a href="07-SEM.html#types-of-models-other-than-growth-models-brief-intro"><i class="fa fa-check"></i><b>7.8</b> Types of models other than growth models (brief intro)</a><ul>
<li class="chapter" data-level="7.8.1" data-path="07-SEM.html"><a href="07-SEM.html#longitudinal-cfa"><i class="fa fa-check"></i><b>7.8.1</b> Longitudinal CFA</a></li>
<li class="chapter" data-level="7.8.2" data-path="07-SEM.html"><a href="07-SEM.html#longitudinal-path-model"><i class="fa fa-check"></i><b>7.8.2</b> Longitudinal Path Model</a></li>
<li class="chapter" data-level="7.8.3" data-path="07-SEM.html"><a href="07-SEM.html#longitudinal-cross-lagged-model"><i class="fa fa-check"></i><b>7.8.3</b> Longitudinal Cross lagged model</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="07-SEM.html"><a href="07-SEM.html#sem-growth-models"><i class="fa fa-check"></i><b>7.9</b> SEM Growth models</a><ul>
<li class="chapter" data-level="7.9.1" data-path="07-SEM.html"><a href="07-SEM.html#introducing-covariatespredictors"><i class="fa fa-check"></i><b>7.9.1</b> introducing covariates/predictors</a></li>
<li class="chapter" data-level="7.9.2" data-path="07-SEM.html"><a href="07-SEM.html#introducing-time-varying-covariates"><i class="fa fa-check"></i><b>7.9.2</b> introducing time varying covariates</a></li>
<li class="chapter" data-level="7.9.3" data-path="07-SEM.html"><a href="07-SEM.html#more-on-mean-structures"><i class="fa fa-check"></i><b>7.9.3</b> More on mean structures</a></li>
<li class="chapter" data-level="7.9.4" data-path="07-SEM.html"><a href="07-SEM.html#multivariate-growth-curves"><i class="fa fa-check"></i><b>7.9.4</b> multivariate growth curves</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="07-SEM.html"><a href="07-SEM.html#multple-groups"><i class="fa fa-check"></i><b>7.10</b> Multple groups</a><ul>
<li class="chapter" data-level="7.10.1" data-path="07-SEM.html"><a href="07-SEM.html#cohort-sequential-designs"><i class="fa fa-check"></i><b>7.10.1</b> Cohort sequential designs</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="07-SEM.html"><a href="07-SEM.html#missing-data-1"><i class="fa fa-check"></i><b>7.11</b> Missing data</a><ul>
<li class="chapter" data-level="7.11.1" data-path="07-SEM.html"><a href="07-SEM.html#planned-missing-data"><i class="fa fa-check"></i><b>7.11.1</b> Planned missing data</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="07-SEM.html"><a href="07-SEM.html#power"><i class="fa fa-check"></i><b>7.12</b> Power</a></li>
</ul></li>
<li class="divider"></li>
<li>Applied Longitudinal Data Analysis</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Longitudinal Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lda-basics" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> LDA basics</h1>
<div id="motivation-terms-concepts" class="section level2">
<h2><span class="header-section-number">2.1</span> Motivation, terms, concepts</h2>
<div id="why-longtiduinal" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Why longtiduinal?</h3>
<p>At least 6 reasons:</p>
<ol style="list-style-type: decimal">
<li><p>Identification of intraindiviaul change (and stability). Do you increase or decrease with time or age. Is this pattern monotonic? Should this best be conceptualized as a stable process or something that is more dynamic? On average how do people change?</p></li>
<li><p>Inter-individual differences in intraindividual change. Does everyone change the same? Do some people start higher but change less? Do some increase while some decrease?</p></li>
<li><p>Examine joint relationship among intraindividual change for two or more constructs. If variable X goes up does variable Y also go up across time? Does this always happen or only during certain times? Is this association due to a third variable or does it mean that change occurs for similar reasons?</p></li>
<li><p>Determinants of intraindividual change. What are the repeated experiences that can push construct X around. Do these have similar effects at all times?</p></li>
<li><p>Determinants of interindividual differences in intraindividual change. Do events, background characteristics, interventions or other between person characteristic shape why certain people change while others don’t?</p></li>
<li><p>Inter-individual differences in intraindividual fluctuation and determinants of intraindividual fluctuation. Does everyone vary the same? Why are some more variable than others?</p></li>
</ol>
</div>
<div id="types-of-change-most-common" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Types of change (most common)</h3>
<p>There are many ways to think of change and stability. We will only have time to go into a few of these types, but it is helpful to think about what type you are interested in when you plan a project or sit down to analyze data.</p>
<ol style="list-style-type: decimal">
<li>Differential / rank order consistency/ rank order stability. Goes by many names but in the end it is just a correlation. This is a group/sample/population level variable and indexes the relative standing of a person with regard to the rest o f the members in the sample. Does not take into account mean structure. Best used with heterotypic continuity where the construct may be the same but the measurement of the construct changes e.g., childhood IQ or acting out in school versus when you are an adult.</li>
</ol>
<p>A specialized case of this is ipsative change, which looks at the rank order of constructs within a person. This is not done on a single variable (depression) but on a broad number of them (all PD symptoms).</p>
<ol start="2" style="list-style-type: decimal">
<li>Mean level/ absolute change. Takes into account mean structure and indexes absolute levels of a construct. A strong assumption is that the construct means (not a pun) the same thing across time. That is, my measure of depression is interpreted the same for a 40 year old and a 90 year old if I want to look at absolute differences between the two ages.</li>
</ol>
<p>Mean level change is not dependent at all on rank order consistency. Can have no mean level change and high rank order consistency and vice versa.</p>
<ol start="3" style="list-style-type: decimal">
<li>Individual differences in change. Rank order and mean level provide an index of change and or stability for the sample. Here this provides an assessment of change for an individual. For example, if it is typical to decline in cognitive ability do some people buck the trend and stay at their past level? Individual differences in change get at both mean level changes as well as the tendency of the sample to show stability. It is the type of change that we will focus on the most.</li>
</ol>
</div>
<div id="between-person-versus-within-person" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Between person versus within person</h3>
<p>Or in other words these are the shortened version of interindividaul differences in change versus intraindividaul differences in change. Refers to across people versus within a particular person. Often we are interested in both simultaneously. Related to Level 1 and Level 2 (for those of you familiar with this terminology).</p>
<p>We may be interested in understanding only between person variability, within person variability or both. When trying to understand within person variability it is typically the case that predictors of between person effects are constant (between person) variables (e.g., gender) that does not change from assessment to assessment. In contrast, within person variability is best understood by time varying predictors (within person variables e.g., daily mood). We will incorporate both time invariant (between person) and time varying (within person) predictors into our eventual model.</p>
</div>
<div id="trajectories-curves-change-growth-oh-my" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Trajectories, curves, change, growth… oh my</h3>
<p>How do we refer to ‘change’? Usually it is easier to refer to pictorially or in terms of an equation. Putting a word onto it usually causes some confusion, which is why there are a lot of redundant terms in the literature. All of these might refer to the same thing when used within a model. However, the names of some models use these terms differently and thus can refer to different models or conditions that you are working with. In this class I will try to point out the important differences but you will be fine if you supplement your terms with graphs or equations.</p>
</div>
</div>
<div id="data-analysis-and-data-structures" class="section level2">
<h2><span class="header-section-number">2.2</span> Data analysis and data structures</h2>
<div id="modeling-frameworks-mlm-sem" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Modeling frameworks: MLM &amp; SEM</h3>
<p>In this class (and in the field) two primary techniques are used with longitudinal models: MLM and SEM. At some levels they are completely equivalent. At others, one is better than the other and vice versa.</p>
<p>MLM/HLM is a simple extension of regression. As a result it is easy to interpret and implement. In terms of longitudinal data it is easier to run models when the time of measurement differs from person to person. For this class we will use lme4 as our MLM program but there are many others we could use e.g., nlme.</p>
<p>SEM is related to regression in that regression is a subset of SEM techniques. In other words, an SEM program could run a simple regression analysis.</p>
<p>The primary advantage of MLM is that you may have assessment waves that vary in length between participants. An assumption of SEM models is that everyone has the same amount of time between assessment waves (though this can be somewhat relaxed). MLM is also better suited for complex error structures and complex nesting above and beyond assessments within person. It is also easier to model interactions.</p>
<p>SEM primary advantage is the ability to account for measurement error via latent assessment of the repeated measures. Other advantages include the ability to model multiple DVs at once, and do so in a flexible manner to look at, for example, the associations between change in one construct and change in the another. Another major advantage is the ability to look at latent groups via latent class or mixture models.</p>
<p>Bottom line: MLM is probably best suited for “basic” growth models. More complex analyses of change would benefit from an SEM approach.</p>
</div>
<div id="wide-and-long-form" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Wide and Long form</h3>
<p>Depending on what type of analysis you want to perform you may need to restructure your data. I recommend the combination of tidyr and dplyr (among others) to restructure and manage your dataframes. The first decision you need to make is whether you want your data structured in a long or a wide format. There are multiple names to refer to these two types: multivariate vs univariate, person-level vs person-period, etc but they all refer to the same idea. How to structure your data depends on both what level of analysis (individual, dyad, household) and what type of analyses (MLM/SEM). Typically our focus is on individuals.</p>
<p>Wide form is common among non-longitudinal data. It has one line per individual with all of their repeated measures in the same row, each with some name to distinguish which assessment wave the data came from. In general, this format is used for SEM.</p>
<pre><code>## # A tibble: 3 x 4
##      ID ext_1 ext_2 ext_3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     4     4     4
## 2     2     6     5     4
## 3     3     4     5     6</code></pre>
<p>In contrast, long format has a row per observation. Thus, participants likely have many rows, each one referring to a different assessment wave. There are fewer variables in this format which makes organization somewhat easier. Thus this has been referred to as “Tidy” data. Graphing with ggplot is facilitated when using tidy data such as being in the long format.</p>
<pre><code>## # A tibble: 9 x 3
##      ID  time   ext
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     1     4
## 2     1     2     4
## 3     1     3     4
## 4     2     1     6
## 5     2     2     5
## 6     2     3     4
## 7     3     1     4
## 8     3     2     5
## 9     3     3     6</code></pre>
<p>How do you go back and forth? To do so use the gather and spread functions of tidyr package. Gather goes from wide to long.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)

wide_to_long &lt;-<span class="st"> </span>wide %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(ext_1:ext_3,<span class="dt">key =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;ext&quot;</span>) 
wide_to_long</code></pre></div>
<pre><code>## # A tibble: 9 x 3
##      ID  time   ext
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 ext_1     4
## 2     2 ext_1     6
## 3     3 ext_1     4
## 4     1 ext_2     4
## 5     2 ext_2     5
## 6     3 ext_2     5
## 7     1 ext_3     4
## 8     2 ext_3     4
## 9     3 ext_3     6</code></pre>
<p>This is equivalent code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wide_to_long &lt;-<span class="st"> </span>wide %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(-ID,<span class="dt">key =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;ext&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(ID)</code></pre></div>
<p>The separate function could be used to get only the assessment wave number. This might be useful when combining data together or for creating a common time metric for everyone.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wide_to_long2 &lt;-<span class="st"> </span>wide_to_long %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(time, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;omit&quot;</span>, <span class="st">&quot;wave&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(-omit) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(ID)
wide_to_long2</code></pre></div>
<pre><code>## # A tibble: 9 x 3
##      ID  wave   ext
##   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
## 1     1     1     4
## 2     1     2     4
## 3     1     3     4
## 4     2     1     6
## 5     2     2     5
## 6     2     3     4
## 7     3     1     4
## 8     3     2     5
## 9     3     3     6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Note that the seperate function will identify non numeric characters and use that to seperate the values. You can omit the sep = function to check yourself. </span></code></pre></div>
<p>One issue that comes up here is that we have differing dates for each assessment. Ideally we would like to utilize that extra information.</p>
<pre><code>## # A tibble: 3 x 7
##      ID ext_1 ext_2 ext_3 date_1  date_2  date_3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;
## 1     1     4     4     4 1/1/10  5/1/10  8/1/10
## 2     2     6     5     4 1/6/10 4/10/10  9/1/10
## 3     3     4     5     6 1/8/10 4/25/10 9/13/10</code></pre>
<p>How do we fix it? The same way we would with multiple variables we want to convert. Wave, along with ID helps us keep track of what variables go with which person at which time. Together, the two serve as a unique identifier. To better understand the code go through each line to see what the intervening data frame looks like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">long.date &lt;-<span class="st"> </span>wide.date %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(-ID, <span class="dt">key =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;value&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(time, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;wave&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(variable,value) 
long.date</code></pre></div>
<pre><code>## # A tibble: 9 x 4
##      ID  wave    date   ext
## * &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
## 1     1     1  1/1/10     4
## 2     1     2  5/1/10     4
## 3     1     3  8/1/10     4
## 4     2     1  1/6/10     6
## 5     2     2 4/10/10     5
## 6     2     3  9/1/10     4
## 7     3     1  1/8/10     4
## 8     3     2 4/25/10     5
## 9     3     3 9/13/10     6</code></pre>
<p>One difficulty of creating a wave variable is whether or not the variables are named in a manner such that 1) assessment wave is easily identifiable (e.g. does _a always refer to the first wave whereas _b always refer to the second?) and 2) if that is consistent across variables. Having a wave identifier for your variables is important/necessary. Having an easily selected one (ie at the end of the variable name, hopefully separated by an underscore or a period). If assessment wave separators are embedded within the variable name it will be harder to covert your data. Often, variable data is attached at the end of a name such as SWB_4 to refer to the fourth item in a scale. This may obscure wave identification as in SWB_A_4. A similar naming problem can occur with multiple reports e.g,. SWB_4_parent. I recommend putting wave identification last. The difficulties become partly moot when working in long format as opposed to wide.</p>
<p>In the above code we used spread to go from long to wide as a means of creating a long dataset where there were multiple variables. Technically this is not a tidy dataset in that it comprises of both long and wide information, but it is the typical format used for MLM analyses.</p>
<p>Going from long to wide uses spread function as seen above, which we will utilize when converting our MLM models to SEM models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">long_to_wide &lt;-<span class="st"> </span>long %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(time, ext)
long_to_wide</code></pre></div>
<pre><code>## # A tibble: 3 x 4
##      ID   `1`   `2`   `3`
## * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     4     4     4
## 2     2     6     5     4
## 3     3     4     5     6</code></pre>
<p>Note that this is technically the dataframe format that we want. The problem is that our variable names are numeric. This often causes problems. When working with tibbles use backticks ‘to refer to the column e.g., select(’1’)</p>
<div id="meaningful-time-metric" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> meaningful time metric</h4>
<p>Time is the most important part of longitudinal analyses. Without some sort of explicit operationalization of time or thought into how you handle time in your analyses you are not conducting longitudinal analyses. The key to interpretting your output is to know how you handled your time variable. What units is it in? Does everyone have the same differences between assessments? Is time something you are explicitly interested in or merely there as a means to collect repeated measures? We will discuss more of these as the semester progresses. Right now however an important distinction is what should the scale of our x-axis variable, time, be in?</p>
<p>At one level, the distinction is relevent to what is the process that is changing someone? Is it a naturally occuring devlopmental process? Then maybe age is the best metric. What about tracking childs cognitive ability, something that might be influenced by level of schooling? Here grade may be more important than age. Another common metric is time in study. This may be usefull if you are running an intervention or if you want to put everyone on the same starting metric and then control for nuisance variables like age or schooling level. Similarly, year of study as a prime time candidate may be useful if you are working from panel studies and interested in historical events and or cohort effects. As seen above,a wave variable (ie study measurement occastion) may be good enough to use as a time metric (though this makes some assumptions about the regularity of assessments both within and across people).</p>
<p>Depending on your choice of time metric you may see different rates of change and variability in change. For psychological applications the most common would be age and time in study (followed by grades for assessments of kids). Age is nice because it captures a number of developmental processes thought to drive change (maturation, history, time-in-study) but does not identify a single reason. Time in study is the opposite in that it does not index any other type of change but that simplicity aides in testing different reasons for change (e.g, age moderation).</p>
</div>
</div>
<div id="graphing" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Graphing</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
</div>
</div>
<div id="putting-it-together-example" class="section level2">
<h2><span class="header-section-number">2.3</span> Putting it together example</h2>
<p>Using some resting state imaging data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example,
   <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st"> </span><span class="kw">geom_point</span>()  
<span class="kw">print</span>(gg1)</code></pre></div>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div id="a-person-level" class="section level3">
<h3><span class="header-section-number">2.3.1</span> a person level</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example,
   <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st"> </span><span class="kw">geom_line</span>()  
gg2</code></pre></div>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>faceting</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example,
   <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">facet_wrap</span>( ~<span class="st"> </span>ID)
gg3</code></pre></div>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example,
   <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>group)
gg4</code></pre></div>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg5 &lt;-<span class="st">  </span>gg2 +<span class="st"> </span><span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(ID)) +<span class="st"> </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="ot">FALSE</span>) 
gg5</code></pre></div>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">11</span>)
ex.random &lt;-<span class="st"> </span>example %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(ID) %&gt;%<span class="st"> </span>
<span class="st">  </span>distinct %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">10</span>) 

example2 &lt;-
<span class="st">  </span><span class="kw">left_join</span>(ex.random, example)  </code></pre></div>
<pre><code>## Joining, by = &quot;ID&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example2,
   <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) +<span class="st"> </span><span class="kw">facet_wrap</span>( ~ID)
gg6</code></pre></div>
<pre><code>## Warning in qt((1 - level)/2, df): NaNs produced

## Warning in qt((1 - level)/2, df): NaNs produced

## Warning in qt((1 - level)/2, df): NaNs produced

## Warning in qt((1 - level)/2, df): NaNs produced

## Warning in qt((1 - level)/2, df): NaNs produced</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>lets look at individual level regressions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(broom)

regressions &lt;-<span class="st"> </span>example2 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(ID) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">lm</span>(SMN7 ~<span class="st"> </span>week, <span class="dt">data=</span>.)))

regressions</code></pre></div>
<pre><code>## # A tibble: 20 x 6
## # Groups:   ID [10]
##       ID        term     estimate   std.error  statistic    p.value
##    &lt;int&gt;       &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1     6 (Intercept)  0.043751626 0.019715849  2.2191095 0.26953127
##  2     6        week -0.011495133 0.016432601 -0.6995322 0.61139970
##  3    29 (Intercept)  0.110400000         NaN        NaN        NaN
##  4    29        week -0.033032982         NaN        NaN        NaN
##  5    48 (Intercept)  0.113337786 0.006560796 17.2750049 0.03681099
##  6    48        week  0.030970692 0.003240913  9.5561620 0.06637719
##  7    54 (Intercept)  0.129501865 0.014599949  8.8700220 0.07147028
##  8    54        week -0.015721671 0.005719476 -2.7487959 0.22212408
##  9    66 (Intercept)  0.069222338 0.034173465  2.0256166 0.29193874
## 10    66        week  0.007679576 0.009070045  0.8466966 0.55272806
## 11    87 (Intercept)  0.078700000         NaN        NaN        NaN
## 12    87        week -0.022742308         NaN        NaN        NaN
## 13    89 (Intercept)  0.079337057 0.020886636  3.7984602 0.16388088
## 14    89        week  0.001695623 0.015490902  0.1094593 0.93059237
## 15   120 (Intercept)  0.127500000         NaN        NaN        NaN
## 16   120        week  0.040389344         NaN        NaN        NaN
## 17   174 (Intercept)  0.158100000         NaN        NaN        NaN
## 18   174        week -0.010711592         NaN        NaN        NaN
## 19   205 (Intercept)  0.195400000         NaN        NaN        NaN
## 20   205        week -0.026256661         NaN        NaN        NaN</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regressions %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(term) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg.reg =</span> <span class="kw">mean</span>(estimate))</code></pre></div>
<pre><code>## # A tibble: 2 x 2
##          term      avg.reg
##         &lt;chr&gt;        &lt;dbl&gt;
## 1 (Intercept)  0.110525067
## 2        week -0.003922511</code></pre>
<p>average trend</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg7 &lt;-<span class="st">  </span>gg1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example, <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">stat_smooth</span>() 
gg7</code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<pre><code>## Warning: Removed 9 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg8 &lt;-<span class="st">  </span><span class="kw">ggplot</span>(example, <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +<span class="st"> </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>group)
gg8</code></pre></div>
<pre><code>## Warning: Removed 9 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(example, <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group =</span> ID)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>) +<span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)   

gg10 &lt;-<span class="st"> </span>gg9 +<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">data =</span> example, <span class="kw">aes</span>(<span class="dt">x =</span> week, <span class="dt">y =</span> SMN7, <span class="dt">group=</span><span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>)


gg11 &lt;-<span class="st"> </span>gg10 +<span class="st"> </span><span class="kw">facet_grid</span>(.~<span class="st"> </span>group) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)

gg11</code></pre></div>
<pre><code>## Warning: Removed 9 rows containing non-finite values (stat_smooth).

## Warning: Removed 9 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="Applied_Longitudinal_Data_Analysis_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
<div id="what-does-this-look-like" class="section level2">
<h2><span class="header-section-number">2.4</span> What does this look like?</h2>
<p>A fancy regression equation. That is it. Seriously.</p>
<p>What is different? Extra error terms, mostly. For regression, we think of error as existing in one big bucket. For MLMs (and other longitudinal models) we will be breaking up unexplained variance (error) into multiple buckets.</p>
<p>This is where fixed effects and random effects come into play. We will discuss this more next class, but the just is that fixed effects are the regression coefficients you are used to. Fixed effects index group level change. Random effects vary among individuals (in the longitudinal models we are talking about) and index variation from the group. For our purposes this is most easily seen thinking about an average group trajectory (fixed effect) and the random effect indexes how much variability there is around that group level effect.</p>
</div>
<div id="design-considerations" class="section level2">
<h2><span class="header-section-number">2.5</span> Design considerations</h2>
<div id="number-of-assessment-waves" class="section level3">
<h3><span class="header-section-number">2.5.1</span> number of assessment waves</h3>
<p>Remember high school algebra: two points define a line. But, that assumes we can measure without error. Three assessment points will better define changes in psychological variables.</p>
</div>
<div id="measuremnt" class="section level3">
<h3><span class="header-section-number">2.5.2</span> measuremnt</h3>
<div id="scale-of-measurement" class="section level4">
<h4><span class="header-section-number">2.5.2.1</span> scale of measurement</h4>
<p>What does it mean for categorical variables to change over time?</p>
<p>Can ranks, such as in preference for school subjects,</p>
<p>How would dichotomous responses impact ability to measure change?</p>
<p>Can I analyze childhood and adult variables simultaneously if assess the same construct, even though they may be measured differently?</p>
</div>
<div id="standardizing" class="section level4">
<h4><span class="header-section-number">2.5.2.2</span> standardizing</h4>
<p>Why would z-scoring your variables be problematic?</p>
</div>
<div id="reliability" class="section level4">
<h4><span class="header-section-number">2.5.2.3</span> reliability</h4>
<p>The goal of longitudinal analyses is to understand why some construct changes or stays the same across time. A major difficulty in addressing this goal is whether you are able to accurately assess the construct of interest. One of the key characteristics (but not the only characteristic) is whether or not your assessment would be consistent if you gave an alternative measure or if you retook it immediately after your first assessment. This is known as reliability of measurement. To the extent that your measure is reliable it assesses true score variance as opposed to error variance. The amount of error score variance assessed is important given that error variance will masquerade as change across time given that error can correlate with anything else. The more error in your measurement the more change you will find. Of course this is unreliable change – change that is not true change, just stochastic noise.</p>
<p>To ensure that your rate of change is reliable assessed, a few thoughts must go into measurement of your variable of interest as well as the number of assessment waves.</p>
</div>
</div>
</div>
<div id="threats-to-validity" class="section level2">
<h2><span class="header-section-number">2.6</span> Threats to validity</h2>
<div id="missing-data" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Missing data</h3>
<div id="types-of-missing-data" class="section level4">
<h4><span class="header-section-number">2.6.1.1</span> types of missing data</h4>
<p>On a scale from 1 to you’re completely screwed, how confident are you that the missingness is not related to your study variables?</p>
<p>Missing completely at random (MCAR) means that the missingness pattern is due entirely to randomness</p>
<p>Missing at random (MAR) means that there is conditional randomness. Missingness may be due to other variables in the dateset. Pretty standard for longitudinal data.</p>
<p>Not missing at random (NMAR) means that the missingness is systematic based on the missing values and not associated with measures variables. For example, in a study of reading ability, kids with low reading ability drop out, due to not liking to take tests on reading ability. However, if reading ability is assocaited with other variables in the model, then this missingness becomes closer in kind of MAR, and thus somewhat less problematic.</p>
<p>Typically, we make the assumption we are working under MAR and thus we will have unbiased estimates when predictors of missingness are incorporated into the model.</p>
</div>
<div id="how-to-handle-missing-data" class="section level4">
<h4><span class="header-section-number">2.6.1.2</span> how to handle missing data</h4>
<p>Listwise? Nah</p>
<p>Full information maximum likelihood and other ML approaches? Sure. Multiple imputation? Cannot hurt.</p>
</div>
</div>
<div id="attritionmortality" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Attrition/Mortality</h3>
<p>Major contributor to missing data</p>
</div>
<div id="historycohort" class="section level3">
<h3><span class="header-section-number">2.6.3</span> History/cohort</h3>
<p>Know that the processes driving change can be due to a specific event or cohort</p>
</div>
<div id="maturation" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Maturation</h3>
<p>Change may occur because of natural processes. Thus if you just follow someone across time they will likely change irregardless of say, if they are in the control group</p>
</div>
<div id="testing" class="section level3">
<h3><span class="header-section-number">2.6.5</span> Testing</h3>
<p>Having people take the same survey, test or interview multiple times may lead them to respond differently. Does that change result from development or does it result from them being familiar with the test?</p>
</div>
<div id="selection" class="section level3">
<h3><span class="header-section-number">2.6.6</span> Selection</h3>
<p>If you are looking at life events, know that life events are not distributed randomly. Moreover, people who stay in studies and even sign up for studies are different from those that do not. As a result, it is often hard to make internally valid inferences with longitudinal data.</p>
</div>
</div>
<div id="why-not-rm-anova" class="section level2">
<h2><span class="header-section-number">2.7</span> Why not RM ANOVA?</h2>
<ol style="list-style-type: decimal">
<li><p>Cannot handle missing data</p></li>
<li><p>Assumes rate of change is the same for all individuals.</p></li>
<li><p>Time is usally done with orthogonal polynomials, making it difficult to interpret or to model non-linear. In other words, you have flexibility on how you want to model time.</p></li>
<li><p>Accounting for correlation across time uses up many paramters, MLM is more efficient.</p></li>
<li><p>Can accomidate differences in time between assessment waves across participants</p></li>
<li><p>Handles arious types of predictors - continuous vs nominal &amp; static vs dynamic</p></li>
</ol>
</div>
<div id="now-you-try" class="section level2">
<h2><span class="header-section-number">2.8</span> Now you try</h2>
<ol style="list-style-type: decimal">
<li><p>Move your data into a long format and a wide format. Did you have any specific challenges that you encountered? If so, discuss them.</p></li>
<li><p>Create a wave variable and date variable (if applicable).</p></li>
<li><p>What is your sample size for each wave of assessment?</p></li>
<li><p>Take the date variable and convert it to a different date format such as time in study or age (if appropriate). What scale is most suitable for your analyses? (weeks/months/years?)</p></li>
<li><p>Graph your data using the different time metrics, fitting individual curves for each person.</p></li>
<li><p>Create an overall average trend of your data (split up into groups if appropriate). Attempt to color your individual data points and/or shade different lines (highlight some particiapnts, highlight the average trend line but not the individual level lines)</p></li>
<li><p>Look at the correlations of your DV across time</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="01-Syllabus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="03-Growth-curves.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
